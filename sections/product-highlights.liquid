{% assign section_setting = section.settings  %}
{% assign blocks = section.blocks %}

<section class="productHighlights">
  <div class="highlights__flex">

    {% if blocks %}
      {% for block in blocks %}
        {% assign block_settings = block.settings %}
        {% assign highlight_image = block_settings.highlight_image %}
        {% assign highlight_link = block_settings.highlight_link %}
        {% assign highlight_title = block_settings.highlight_title %}
        {% assign highlight_subheading = block_settings.highlight_subheading %}
        {% assign product = all_products[block_settings.product] %}
        {% assign product_image = product.featured_image %}
        {% assign product_url = product.url %}
        {% assign product_title = product.title %}

        <div class="highlight__highlights">
          <a href="{{ product_url }}">
            <img src="{{ product_image | img_url: 'master' }}"/>
          </a>
          <h2>{{ highlight_title }}</h2>
          <h4>{{ highlight_subheading }}</h4>
        </div>
      {% endfor %}
    {% endif %}

  </div>
</section>

{% stylesheet %}
    .productHighlights{
        padding-top: 10px;    
        border-bottom: 1px solid #D3D3D3; 
    }
    .highlights__flex{
        display: flex;
        justify-content: space-between;
    }
    .highlight__highlights{
        width: 32%;
        text-align: center;
    }
{% endstylesheet %}

{% schema %}
    {
        "name": "Product Highlights",
        "settings": [
        ],
        "blocks": [
          {
            "type": "product_highlight",
            "name": "Product highlight",
            "settings": [
              {
                  "type": "product",
                  "id": "product",
                  "label": "Product"
              },
              {
                  "type": "image_picker",
                  "id": "highlight_image",
                  "label": "Product Image"
              },
              {
                  "type": "url",
                  "id": "highlight_link",
                  "label": "Product Link"
              },
              {
                  "type": "text",
                  "id": "highlight_title",
                  "label": "Title"
              },
              {
                "type": "richtext",
                "id": "highlight_subheading",
                "label": "Subheading"
              }
            ]
          }
        ],
        "presets": [
            {
                "name": "product highlights",
                "category": "General",
                "settings": {}
            }
        ]
    }
{% endschema %}
